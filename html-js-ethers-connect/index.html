<!-- <!DOCTYPE html>
<html>
    <head>
        <title>Javascript Test</title>
    </head>

    <body>
        <button id="connectButton" onclick="connect()">Connect</button>
        <button id="executeButton" onclick="bundle.execute()">Execute</button>

        <script>
            async function connect() {
                if (typeof window.ethereum !== "undefined") {
                    ethereum.request({ method: "eth_requestAccounts" });
                }
            }
            
            console.log("We see metamask");
        </script>
        <button class="connectButton" onclick="connect()">Connect</button>
    </body>

</html> -->

<!DOCTYPE html>
<html>
    <head>
        <title>Javascript Test</title>
    </head>

    <body>
        <script>
            let isRequesting = false;

            async function connect() {
                if (typeof window.ethereum !== "undefined") {
                    if (isRequesting) {
                        console.log("A request is already pending. Pleasee wait.");
                        return;
                    }

                    isRequesting = true;

                    try {
                        //Request accounts from MetaMask
                        const accounts = await ethereum.request({ method: "eth_requestAccounts"});
                        console.log("Connected accounts:", accounts);
                    } catch (error) {
                        console.error("Error connecting to MetaMask:", error.message);
                    } finally {
                        isRequesting = false;
                    }
                } else {
                    console.log("MetaMask is not installed. Please install it to use this feature.");
                }
            }
        </script>
        <button class="connectButton" onclick="connect()">Connect</button>
    </body>
</html>